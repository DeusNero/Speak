<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a1e22">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="manifest" href="manifest.json">
    <title>Speak</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,600&family=Spectral:ital,wght@0,300;0,400;0,500;1,300;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
<div class="app">
    <!-- SPEAK -->
    <div id="speak-screen" class="screen active"><div class="speak-screen">
        <div class="mode-toggle" style="position:absolute;top:20px;left:20px;display:flex;background:var(--glass-bg-light);backdrop-filter:blur(16px) saturate(1.1);-webkit-backdrop-filter:blur(16px) saturate(1.1);border-radius:var(--radius-full);padding:3px;border:1px solid var(--glass-border);z-index:10;"><button class="mode-toggle-btn active" data-mode="thought" style="padding:6px 10px;border:none;cursor:pointer;border-radius:var(--radius-full);transition:all .25s ease;display:flex;align-items:center;"><svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 21l-1.5-1.3C5.4 15.4 2 12.3 2 8.5 2 5.4 4.4 3 7.5 3c1.7 0 3.4.8 4.5 2.1"/><path d="M12 5.1C13.1 3.8 14.8 3 16.5 3 19.6 3 22 5.4 22 8.5c0 3.8-3.4 6.9-8.5 11.2L12 21"/><line x1="12" y1="3" x2="12" y2="21"/><path d="M4 9c1.5-.5 3 .5 3.5 1.5s0 2.5-1 3"/><path d="M5.5 7c1-.5 2.5 0 3 1"/><path d="M8 13c-1 .5-1.5 2-.5 2.5"/></svg></button><button class="mode-toggle-btn" data-mode="habit" style="padding:6px 10px;border:none;cursor:pointer;border-radius:var(--radius-full);transition:all .25s ease;display:flex;align-items:center;"><svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22V12"/><path d="M12 12C12 8 8 6 4 7c0 4 2 7 8 5"/><path d="M12 12c0-4 4-6 8-5 0 4-2 7-8 5"/><path d="M12 22c-2 0-3-1-3-3"/><path d="M12 22c2 0 3-1 3-3"/></svg></button></div>
        <div class="lang-toggle"><button class="lang-btn active" data-lang="de-DE">DE</button><button class="lang-btn" data-lang="en-US">EN</button></div>
        <div class="speak-greeting" id="greeting-text">Take a moment</div>
        <div class="speak-subtitle">Speak whatâ€™s on your mind</div>
        <div class="speak-btn-container">
            <div class="sand-ripple"></div><div class="sand-ripple"></div><div class="sand-ripple"></div><div class="sand-ripple"></div>
            <div class="long-press-progress" id="long-press-ring"></div><button class="speak-btn" id="speak-btn"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 21l-1.5-1.3C5.4 15.4 2 12.3 2 8.5 2 5.4 4.4 3 7.5 3c1.7 0 3.4.8 4.5 2.1"/><path d="M12 5.1C13.1 3.8 14.8 3 16.5 3 19.6 3 22 5.4 22 8.5c0 3.8-3.4 6.9-8.5 11.2L12 21"/><line x1="12" y1="3" x2="12" y2="21"/><path d="M4 9c1.5-.5 3 .5 3.5 1.5s0 2.5-1 3"/><path d="M5.5 7c1-.5 2.5 0 3 1"/><path d="M8 13c-1 .5-1.5 2-.5 2.5"/></svg><span class="speak-btn-label">Speak</span></button>
        </div>
        <div class="speak-timer" id="speak-timer">0:00</div>
    </div></div>

    <!-- POST-RECORDING -->
    <div id="post-record-screen" class="screen"><div class="post-record-screen">
        <div class="post-record-step active" id="mood-step">
            <div class="step-label">How are you feeling right now?</div>
            <div class="mood-selector" id="general-mood-row"><button class="mood-btn general-mood-btn" data-mood="1">ğŸ˜¢</button><button class="mood-btn general-mood-btn" data-mood="2">ğŸ˜•</button><button class="mood-btn general-mood-btn" data-mood="3">ğŸ˜</button><button class="mood-btn general-mood-btn" data-mood="4">ğŸ™‚</button><button class="mood-btn general-mood-btn" data-mood="5">ğŸ˜Š</button></div>
            <div class="btn-group"><button class="action-btn primary" id="mood-next" style="background:linear-gradient(135deg,#d4c4a0 0%,#c4b48a 50%,#a89870 100%);color:var(--bg-deep);">Save</button><button class="action-btn secondary" id="mood-skip" style="background:rgba(196,180,138,.15);border-color:rgba(196,180,138,.25);color:#c4b48a;">Skip</button></div>
        </div>
    </div></div>

    <!-- THOUGHTS -->
    <div id="thoughts-screen" class="screen"><div class="thoughts-screen">
        <div class="thoughts-header"><div class="thoughts-title">Thoughts</div>
            <div class="view-toggle"><button class="view-toggle-btn active" data-view="feed"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="6" rx="2"/><rect x="3" y="13" width="18" height="8" rx="2"/></svg></button><button class="view-toggle-btn" data-view="list"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><circle cx="4" cy="6" r="1" fill="currentColor"/><circle cx="4" cy="12" r="1" fill="currentColor"/><circle cx="4" cy="18" r="1" fill="currentColor"/></svg></button></div>
        </div>
        <div class="search-bar"><svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg><input type="text" class="search-input" id="search-input" autocomplete="off" data-form-type="other" readonly onfocus="this.removeAttribute('readonly')" placeholder="Search your thoughts..."></div>
        <div class="filter-bar">
            <button class="filter-chip active" data-filter="all">All</button><button class="filter-chip" data-filter="emotion">Thought</button><button class="filter-chip" data-filter="habit">Habit</button><button class="filter-chip" data-filter="untagged">âŒ›</button>
            <button class="filter-icon-btn" id="mood-filter-btn" title="Filter by mood"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></svg></button>
            <button class="filter-icon-btn" id="date-picker-btn" title="Filter by date"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg></button>
            <input type="date" class="hidden-date-input" id="date-filter-input">
        </div>
        <div class="capture-list" id="capture-list"></div>
        <div class="floating-speak-wrap" style="position:fixed;bottom:120px;right:20px;z-index:50;display:flex;align-items:center;justify-content:center;">
            <div class="sand-ripple" style="position:absolute;inset:-10px;border-radius:50%;border:1.5px solid rgba(196,180,138,.25);animation:breatheRing 4s ease-in-out infinite;"></div>
            <div class="sand-ripple" style="position:absolute;inset:-22px;border-radius:50%;border:1.5px solid rgba(196,180,138,.2);animation:breatheRing 4s ease-in-out infinite .6s;"></div>
            <div class="sand-ripple" style="position:absolute;inset:-35px;border-radius:50%;border:1.5px solid rgba(196,180,138,.15);animation:breatheRing 4s ease-in-out infinite 1.2s;opacity:.7;"></div>
            <div class="long-press-progress" id="thoughts-lp-ring"></div>
            <div class="floating-speak-timer" id="thoughts-speak-timer">0:00</div>
            <button class="speak-btn" id="thoughts-speak-btn" style="width:66px;height:66px;position:relative;z-index:2;box-shadow:0 4px 16px rgba(0,0,0,.4);font-size:11px;">
                <svg viewBox="0 0 24 24" style="width:26px;height:26px" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 21l-1.5-1.3C5.4 15.4 2 12.3 2 8.5 2 5.4 4.4 3 7.5 3c1.7 0 3.4.8 4.5 2.1"/><path d="M12 5.1C13.1 3.8 14.8 3 16.5 3 19.6 3 22 5.4 22 8.5c0 3.8-3.4 6.9-8.5 11.2L12 21"/><line x1="12" y1="3" x2="12" y2="21"/><path d="M4 9c1.5-.5 3 .5 3.5 1.5s0 2.5-1 3"/><path d="M5.5 7c1-.5 2.5 0 3 1"/><path d="M8 13c-1 .5-1.5 2-.5 2.5"/></svg>
                <span class="speak-btn-label" style="font-size:10px;">Speak</span>
            </button>
        </div>
    </div></div>

    <!-- DETAIL -->
    <div id="detail-screen" class="screen"><div class="detail-screen">
        <button class="detail-back" id="detail-back"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="15 18 9 12 15 6"/></svg>Back</button>
        <div class="detail-header"><div class="detail-date" id="detail-date"></div><div style="display:flex;gap:6px;align-items:center;"><div class="detail-mood" id="detail-mood"></div><div class="detail-mood" id="detail-event-mood" style="opacity:.7;"></div></div></div>
        <div class="detail-tags" id="detail-tags"></div>
        <div class="detail-text" id="detail-text"></div>
        <div class="detail-actions" style="display:flex;align-items:center;justify-content:center;gap:12px;">
            <button class="detail-action-btn" id="detail-edit"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4z"/></svg>Edit</button>
            <div class="gemini-btn-wrap"><div class="gemini-ripple"></div><div class="gemini-ripple"></div><button class="detail-action-btn refine" id="detail-refine" style="width:44px;height:44px;border-radius:50%;border:1px solid rgba(196,180,138,.3);background:rgba(196,180,138,.1);display:flex;align-items:center;justify-content:center;padding:0;position:relative;z-index:1;"><svg style="width:18px;height:18px;" viewBox="0 0 24 24" fill="none"><path d="M12 2L13.5 8.5L20 10L13.5 11.5L12 18L10.5 11.5L4 10L10.5 8.5L12 2Z" fill="#c4b48a"/><path d="M18 14L18.75 16.5L21 17.25L18.75 18L18 20.5L17.25 18L15 17.25L17.25 16.5L18 14Z" fill="#c4b48a" opacity=".7"/></svg></button></div>
            <button class="detail-action-btn danger" id="detail-delete"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>Delete</button></div>
    </div></div>

    <!-- HABITS -->
    <div id="habits-screen" class="screen"><div class="thoughts-screen">
        <div class="thoughts-header"><div class="thoughts-title">Habits</div>
            <div class="view-toggle" id="habits-view-toggle"><button class="view-toggle-btn habit-view-btn active" data-view="feed"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="6" rx="2"/><rect x="3" y="13" width="18" height="8" rx="2"/></svg></button><button class="view-toggle-btn habit-view-btn" data-view="list"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><circle cx="4" cy="6" r="1" fill="currentColor"/><circle cx="4" cy="12" r="1" fill="currentColor"/><circle cx="4" cy="18" r="1" fill="currentColor"/></svg></button></div>
        </div>
        <div class="search-bar"><svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg><input type="text" class="search-input" id="habit-search-input" placeholder="Search habits..." autocomplete="off" data-form-type="other" readonly onfocus="this.removeAttribute('readonly')"></div>
        <div id="habits-overdue-banner" style="display:none;"></div>
        <div id="habits-list" class="capture-list"></div>
        <div class="floating-speak-wrap" style="position:fixed;bottom:120px;right:20px;z-index:50;display:flex;align-items:center;justify-content:center;">
            <div class="sand-ripple" style="position:absolute;inset:-10px;border-radius:50%;border:1.5px solid rgba(90,138,90,.3);animation:breatheRing 4s ease-in-out infinite;"></div>
            <div class="sand-ripple" style="position:absolute;inset:-22px;border-radius:50%;border:1.5px solid rgba(90,138,90,.25);animation:breatheRing 4s ease-in-out infinite .6s;"></div>
            <div class="sand-ripple" style="position:absolute;inset:-35px;border-radius:50%;border:1.5px solid rgba(90,138,90,.2);animation:breatheRing 4s ease-in-out infinite 1.2s;opacity:.7;"></div>
            <div class="long-press-progress" id="habits-lp-ring" style="border-top-color:#5e8a5a;"></div>
            <div class="floating-speak-timer" id="habits-speak-timer">0:00</div>
            <button class="speak-btn" id="habits-speak-btn" style="width:66px;height:66px;position:relative;z-index:2;box-shadow:0 4px 16px rgba(0,0,0,.4);font-size:11px;background:radial-gradient(circle at 45% 40%,#7da87a 0%,#5e8a5a 35%,#4a7248 70%,#3a5e38 100%);">
                <svg viewBox="0 0 24 24" style="width:26px;height:26px" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22V12"/><path d="M12 12C12 8 8 6 4 7c0 4 2 7 8 5"/><path d="M12 12c0-4 4-6 8-5 0 4-2 7-8 5"/><path d="M12 22c-2 0-3-1-3-3"/><path d="M12 22c2 0 3-1 3-3"/></svg>
                <span class="speak-btn-label" style="font-size:10px;">Speak</span>
            </button>
        </div>
    </div></div>

    <!-- HABIT DETAIL -->
    <div id="habit-detail-screen" class="screen"><div class="detail-screen">
        <div class="detail-header">
            <button class="detail-back" id="habit-detail-back"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="15 18 9 12 15 6"/></svg>Back</button>
        </div>
        <div class="thoughts-header" style="margin-bottom:12px;"><div class="thoughts-title" style="display:flex;align-items:center;gap:8px;"><svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22V12"/><path d="M12 12C12 8 8 6 4 7c0 4 2 7 8 5"/><path d="M12 12c0-4 4-6 8-5 0 4-2 7-8 5"/><path d="M12 22c-2 0-3-1-3-3"/><path d="M12 22c2 0 3-1 3-3"/></svg>Log your habits</div></div>
        <div id="habit-detail-name" class="detail-text" style="font-size:22px;font-weight:600;margin-bottom:4px;"></div>
        <div id="habit-streak-msg" style="font-size:13px;color:var(--accent-moss);margin-bottom:4px;"></div>
        <div id="habit-inactivity-msg" style="font-size:13px;margin-bottom:16px;"></div>
        <div id="habit-entries-list" class="capture-list"></div>
        <div class="floating-speak-wrap" style="position:fixed;bottom:120px;right:20px;z-index:50;display:flex;align-items:center;justify-content:center;">
            <div class="sand-ripple" style="position:absolute;inset:-10px;border-radius:50%;border:1.5px solid rgba(90,138,90,.3);animation:breatheRing 4s ease-in-out infinite;"></div>
            <div class="sand-ripple" style="position:absolute;inset:-22px;border-radius:50%;border:1.5px solid rgba(90,138,90,.25);animation:breatheRing 4s ease-in-out infinite .6s;"></div>
            <div class="sand-ripple" style="position:absolute;inset:-35px;border-radius:50%;border:1.5px solid rgba(90,138,90,.2);animation:breatheRing 4s ease-in-out infinite 1.2s;opacity:.7;"></div>
            <div class="long-press-progress" id="habit-lp-ring" style="border-top-color:#5e8a5a;"></div>
            <div class="floating-speak-timer" id="habit-speak-timer">0:00</div>
            <button class="speak-btn" id="habit-speak-btn" style="width:66px;height:66px;position:relative;z-index:2;box-shadow:0 4px 16px rgba(0,0,0,.4);font-size:11px;background:radial-gradient(circle at 45% 40%,#7da87a 0%,#5e8a5a 35%,#4a7248 70%,#3a5e38 100%);">
                <svg viewBox="0 0 24 24" style="width:26px;height:26px" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22V12"/><path d="M12 12C12 8 8 6 4 7c0 4 2 7 8 5"/><path d="M12 12c0-4 4-6 8-5 0 4-2 7-8 5"/><path d="M12 22c-2 0-3-1-3-3"/><path d="M12 22c2 0 3-1 3-3"/></svg>
                <span class="speak-btn-label" style="font-size:10px;">Speak</span>
            </button>
        </div>
    </div></div>

    <!-- ADD HABIT MODAL -->
    <div class="modal-overlay" id="add-habit-overlay"><div class="modal-dialog" style="max-width:380px;padding:24px;">
        <button class="modal-close-x" id="add-habit-close-x"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
        <div class="modal-title" style="margin-bottom:16px;">New habit</div>
        <input type="text" id="habit-name-input" name="habit-nofill" autocomplete="off" data-form-type="other" readonly onfocus="this.removeAttribute('readonly')" placeholder="Habit (e.g. Breathwork, Stretching)" style="width:100%;padding:12px 14px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);color:var(--text-primary);font-family:var(--font-body);font-size:15px;outline:none;box-sizing:border-box;margin-bottom:16px;">
        <div style="display:flex;gap:10px;justify-content:center;">
            <button class="action-btn secondary" id="add-habit-cancel" style="min-width:0;flex:1;background:rgba(90,140,85,.15);border-color:rgba(90,140,85,.25);color:#7da87a;">Cancel</button>
            <button class="action-btn primary" id="add-habit-save" style="min-width:0;flex:1;background:linear-gradient(135deg,#7da87a 0%,#5e8a5a 50%,#4a7248 100%);color:var(--bg-deep);border:none;">Create</button>
        </div>
    </div></div>

    <!-- HABIT PICKER MODAL (for tagging from Speak screen) -->
    <div class="modal-overlay" id="habit-picker-overlay"><div style="display:flex;flex-direction:column;align-items:center;gap:10px;width:100%;max-width:340px;margin:0 auto;"><div class="modal-dialog" style="max-width:340px;padding:24px;width:100%;margin:0;position:relative;">
        <button class="modal-close-x" id="habit-picker-close-x"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
        <div class="modal-title" style="margin-bottom:4px;">Add to your habits</div><div style="font-size:13px;color:#5e8a5a;margin-bottom:16px;font-style:italic;">Small steps. every day.</div>
        <div id="habit-picker-list" style="max-height:250px;overflow-y:auto;display:flex;flex-direction:column;gap:8px;margin-bottom:16px;"></div>
        <div id="habit-picker-empty" style="text-align:center;color:var(--text-muted);font-size:14px;padding:20px 0;">No habits yet.</div>
    </div><div class="modal-dialog" style="max-width:340px;padding:14px 24px;width:100%;margin:0;position:relative;"><button id="habit-picker-add-fixed" style="padding:12px 16px;background:linear-gradient(135deg,#7da87a 0%,#5e8a5a 50%,#4a7248 100%);border:none;border-radius:var(--radius-md);color:var(--bg-deep);font-family:var(--font-body);font-size:14px;cursor:pointer;text-align:center;font-weight:500;width:100%;">+ Add new habit</button></div></div></div>

    <!-- HABIT ENTRY DETAIL (full screen) -->
    <div id="habit-entry-detail-screen" class="screen"><div class="detail-screen">
        <button class="detail-back" id="habit-entry-back"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="15 18 9 12 15 6"/></svg>Back</button>
        <div class="detail-header"><div class="detail-date" id="he-detail-date"></div></div>
        <div id="he-detail-title" style="font-size:18px;font-weight:600;color:var(--text-primary);margin-bottom:8px;display:none;"></div>
        <div class="detail-text" id="he-detail-text"></div>
        <div class="detail-actions" style="display:flex;align-items:center;justify-content:center;gap:12px;">
            <button class="detail-action-btn" id="he-detail-edit" style="border-color:rgba(90,140,85,.25);color:#7da87a;"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4z"/></svg>Edit</button>
            <div class="gemini-btn-wrap"><div class="gemini-ripple" style="border-color:rgba(90,140,85,.2);"></div><div class="gemini-ripple" style="border-color:rgba(90,140,85,.15);"></div><button class="detail-action-btn refine" id="he-detail-refine" style="width:44px;height:44px;border-radius:50%;border:1px solid rgba(90,140,85,.3);background:rgba(90,140,85,.1);display:flex;align-items:center;justify-content:center;padding:0;position:relative;z-index:1;"><svg style="width:18px;height:18px;" viewBox="0 0 24 24" fill="none"><path d="M12 2L13.5 8.5L20 10L13.5 11.5L12 18L10.5 11.5L4 10L10.5 8.5L12 2Z" fill="#5e8a5a"/><path d="M18 14L18.75 16.5L21 17.25L18.75 18L18 20.5L17.25 18L15 17.25L17.25 16.5L18 14Z" fill="#5e8a5a" opacity=".7"/></svg></button></div>
            <button class="detail-action-btn danger" id="he-detail-delete"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>Delete</button>
        </div>
    </div></div>

    <!-- VOICE TITLE PROMPT -->
    <div class="modal-overlay" id="voice-title-overlay"><div class="modal-dialog" style="max-width:340px;padding:24px;text-align:center;">
        <div class="modal-title" style="margin-bottom:16px;">Add a title?</div>
        <input type="text" id="voice-title-input" autocomplete="off" data-form-type="other" readonly onfocus="this.removeAttribute('readonly')" placeholder="e.g. hugs, hold hand..." style="width:100%;padding:10px 14px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);color:var(--text-primary);font-family:var(--font-body);font-size:14px;outline:none;box-sizing:border-box;margin-bottom:16px;">
        <div style="display:flex;gap:10px;">
            <button class="action-btn secondary" id="voice-title-skip" style="min-width:0;flex:1;background:rgba(90,140,85,.15);border-color:rgba(90,140,85,.25);color:#7da87a;">Skip</button>
            <button class="action-btn primary" id="voice-title-save" style="min-width:0;flex:1;background:linear-gradient(135deg,#7da87a 0%,#5e8a5a 50%,#4a7248 100%);color:var(--bg-deep);border:none;">Save</button>
        </div>
    </div></div>

    <!-- DELETE HABIT CONFIRM -->
    <div class="modal-overlay" id="delete-habit-overlay"><div class="modal-dialog" style="max-width:320px;padding:24px;">
        <div class="modal-title" style="margin-bottom:8px;">Delete this habit?</div>
        <div style="color:var(--text-muted);font-size:14px;margin-bottom:20px;">This will delete the habit and all its entries. This cannot be undone.</div>
        <div style="display:flex;gap:10px;">
            <button class="action-btn secondary" id="delete-habit-cancel" style="min-width:0;flex:1;background:rgba(196,180,138,.15);border-color:rgba(196,180,138,.25);color:#c4b48a;">Cancel</button>
            <button class="action-btn danger" id="delete-habit-confirm" style="min-width:0;flex:1;">Delete</button>
        </div>
    </div></div>

    <!-- DELETE HABIT ENTRY CONFIRM -->
    <div class="modal-overlay" id="entry-delete-overlay"><div class="modal-dialog" style="max-width:320px;padding:24px;">
        <div class="modal-title" style="margin-bottom:8px;">Delete this entry?</div>
        <div style="color:var(--text-muted);font-size:14px;margin-bottom:20px;">This action cannot be undone.</div>
        <div style="display:flex;gap:10px;">
            <button class="action-btn secondary" id="entry-delete-cancel" style="min-width:0;flex:1;background:rgba(196,180,138,.15);border-color:rgba(196,180,138,.25);color:#c4b48a;">Cancel</button>
            <button class="action-btn danger" id="entry-delete-confirm" style="min-width:0;flex:1;">Delete</button>
        </div>
    </div></div>

    <!-- SETTINGS -->
    <div id="settings-screen" class="screen"><div class="settings-screen">
        <button class="detail-back" onclick="showScreen('speak-screen')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="15 18 9 12 15 6"/></svg>Back</button><div class="settings-title">Settings</div>
        <div class="settings-group"><div class="settings-group-label">Data</div>
            <div class="settings-item"><div class="settings-item-left"><div class="settings-item-label">Export all data</div><div class="settings-item-sublabel" id="last-backup">Never backed up</div></div><div class="settings-item-right"><button class="settings-action-btn" id="export-btn" title="Download backup"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg></button></div></div>
            <div class="settings-item"><div class="settings-item-left"><div class="settings-item-label">Import backup</div><div class="settings-item-sublabel">Restore from a backup file</div></div><div class="settings-item-right"><button class="settings-action-btn" id="import-btn" title="Restore backup"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg></button></div></div>
            <input type="file" id="import-file-input" accept=".json" style="display:none">
        </div>
        <div class="settings-group"><div class="settings-group-label">AI Refinement</div>
            <div class="settings-item"><div class="settings-item-left"><div class="settings-item-label">Gemini API Key</div><div class="settings-item-sublabel" id="api-key-status">Not configured</div></div><div class="settings-item-right"><button class="settings-action-btn" id="api-key-btn" title="Set API key"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg></button></div></div>
        </div>
        <div class="settings-group"><div class="settings-group-label">Default Language</div>
            <div class="settings-item"><div class="settings-item-left"><div class="settings-item-label">Speech recognition</div><div class="settings-item-sublabel">Can be changed per recording</div></div><div class="settings-item-right"><div class="settings-lang-toggle" id="settings-lang-toggle"><button class="settings-lang-btn active" data-lang="de-DE">DE</button><button class="settings-lang-btn" data-lang="en-US">EN</button></div></div></div>
        </div>
        <div class="settings-group"><div class="settings-group-label">About</div>
            <div class="settings-item"><div class="settings-item-left"><div class="settings-item-label">Version</div></div><div class="settings-item-right">1.2.0</div></div>
            <div class="settings-item"><div class="settings-item-left"><div class="settings-item-label">Total captures</div></div><div class="settings-item-right" id="total-captures">0</div></div>
        </div>
    </div></div>

    <!-- TAB BAR -->
    <nav class="tab-bar">
        <button class="tab-item active" data-screen="speak-screen"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/></svg>Speak</button>
        <button class="tab-item" data-screen="thoughts-screen"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 21l-1.5-1.3C5.4 15.4 2 12.3 2 8.5 2 5.4 4.4 3 7.5 3c1.7 0 3.4.8 4.5 2.1"/><path d="M12 5.1C13.1 3.8 14.8 3 16.5 3 19.6 3 22 5.4 22 8.5c0 3.8-3.4 6.9-8.5 11.2L12 21"/><line x1="12" y1="3" x2="12" y2="21"/><path d="M4 9c1.5-.5 3 .5 3.5 1.5s0 2.5-1 3"/><path d="M5.5 7c1-.5 2.5 0 3 1"/><path d="M8 13c-1 .5-1.5 2-.5 2.5"/></svg>Thoughts</button>
        <button class="tab-item" data-screen="habits-screen"><svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22V12"/><path d="M12 12C12 8 8 6 4 7c0 4 2 7 8 5"/><path d="M12 12c0-4 4-6 8-5 0 4-2 7-8 5"/><path d="M12 22c-2 0-3-1-3-3"/><path d="M12 22c2 0 3-1 3-3"/></svg>Habits</button>
        <button class="tab-item" data-screen="settings-screen"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>Settings</button>
    </nav>

    <!-- OVERLAYS -->
    <div class="success-overlay" id="success-overlay"><div class="success-content"><div class="success-check"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><polyline points="6 12 10 16 18 8"/></svg></div><div class="success-text">Saved</div></div></div>
    <div class="modal-overlay" id="confirm-overlay"><div class="modal-dialog" style="max-width:320px;padding:24px;"><button class="modal-close-x" id="confirm-close-x"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button><div class="modal-title">Delete this thought?</div><div class="modal-text">This action cannot be undone.</div><div class="modal-btns" style="display:flex;gap:10px;"><button class="action-btn secondary" id="confirm-cancel" style="min-width:0;flex:1;">Cancel</button><button class="action-btn danger" id="confirm-action" style="min-width:0;flex:1;">Delete</button></div></div></div>
    <div class="modal-overlay" id="mood-filter-overlay"><div class="modal-dialog"><button class="modal-close-x" id="mood-modal-close-x"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button><div class="modal-title">Filter by mood</div><div style="display:flex;gap:10px;justify-content:center;margin:20px 0 16px;flex-wrap:wrap;"><button class="mood-btn mood-filter-opt" data-mood="0" style="font-size:12px;color:var(--text-muted);width:48px;height:48px;">All</button><button class="mood-btn mood-filter-opt" data-mood="1">ğŸ˜¢</button><button class="mood-btn mood-filter-opt" data-mood="2">ğŸ˜•</button><button class="mood-btn mood-filter-opt" data-mood="3">ğŸ˜</button><button class="mood-btn mood-filter-opt" data-mood="4">ğŸ™‚</button><button class="mood-btn mood-filter-opt" data-mood="5">ğŸ˜Š</button></div><button class="action-btn secondary" id="mood-modal-close" style="width:100%;background:rgba(196,180,138,.15);border-color:rgba(196,180,138,.25);color:#c4b48a;">Close</button></div></div>
    <div class="edit-modal" id="edit-modal"><div class="edit-modal-inner"><div class="edit-modal-header"><button class="edit-modal-cancel" id="edit-cancel">Cancel</button><div class="edit-modal-title">Edit</div><button class="edit-modal-save" id="edit-save">Save</button></div><div class="edit-modal-body"><input type="text" id="edit-title-input" autocomplete="off" data-form-type="other" readonly onfocus="this.removeAttribute('readonly')" placeholder="Title (optional)" style="display:none;width:100%;padding:10px 14px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);color:var(--text-primary);font-family:var(--font-body);font-size:14px;outline:none;box-sizing:border-box;margin-bottom:10px;"><textarea class="edit-textarea" id="edit-text-input" autocomplete="off" data-form-type="other"></textarea></div><div class="edit-section-label" style="padding:0 18px;">General mood</div><div class="edit-mood-row" id="edit-mood-row" style="padding:0 18px;"><button class="edit-mood-btn" data-mood="1">ğŸ˜¢</button><button class="edit-mood-btn" data-mood="2">ğŸ˜•</button><button class="edit-mood-btn" data-mood="3">ğŸ˜</button><button class="edit-mood-btn" data-mood="4">ğŸ™‚</button><button class="edit-mood-btn" data-mood="5">ğŸ˜Š</button><button class="edit-mood-btn" data-mood="0" style="font-size:12px;color:var(--text-muted);">None</button></div><div class="edit-section-label" style="padding:0 18px;">Event mood</div><div class="edit-mood-row" id="edit-event-mood-row" style="padding:0 18px;"><button class="edit-event-mood-btn" data-mood="1">ğŸ˜¢</button><button class="edit-event-mood-btn" data-mood="2">ğŸ˜•</button><button class="edit-event-mood-btn" data-mood="3">ğŸ˜</button><button class="edit-event-mood-btn" data-mood="4">ğŸ™‚</button><button class="edit-event-mood-btn" data-mood="5">ğŸ˜Š</button><button class="edit-event-mood-btn" data-mood="0" style="font-size:12px;color:var(--text-muted);">None</button></div><div class="edit-section-label" style="padding:0 18px;">Tags</div><div class="edit-tag-row" id="edit-tag-row" style="padding:0 18px 18px;"><button class="edit-tag-btn" data-tag="emotion">Thought</button><button class="edit-tag-btn" data-tag="habit">Habit</button></div></div></div>
    <!-- QUICK EDIT OVERLAY -->
    <div class="modal-overlay" id="quick-edit-overlay"><div class="modal-dialog" style="max-width:380px;padding:24px;">
        <button class="modal-close-x" id="quick-edit-close-x"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
        <div class="modal-title" id="quick-edit-title" style="margin-bottom:16px;">Edit</div>
        <textarea id="quick-edit-input" autocomplete="off" data-form-type="other" readonly onfocus="this.removeAttribute('readonly')" style="width:100%;min-height:100px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);padding:14px;color:var(--text-primary);font-family:var(--font-body);font-size:15px;line-height:1.6;resize:vertical;outline:none;box-sizing:border-box;"></textarea>
        <div style="display:flex;gap:10px;margin-top:16px;">
            <button class="action-btn secondary" id="quick-edit-cancel" style="min-width:0;flex:1;background:rgba(90,140,85,.15);border-color:rgba(90,140,85,.25);color:#7da87a;">Cancel</button>
            <button class="action-btn primary" id="quick-edit-save" style="min-width:0;flex:1;background:linear-gradient(135deg,#7da87a 0%,#5e8a5a 50%,#4a7248 100%);color:var(--bg-deep);border:none;">Save</button>
        </div>
    </div></div>
    <!-- EXPORT MODAL -->
    <div class="modal-overlay" id="export-overlay"><div class="modal-dialog" style="max-width:380px;padding:24px;text-align:center;">
        <button class="modal-close-x" id="export-close-x"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
        <div class="modal-title" style="margin-bottom:6px;">Export data</div>
        <div style="font-size:13px;color:var(--text-muted);margin-bottom:16px;">Download all your data as a JSON file</div>
        <div style="background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);padding:14px;margin-bottom:16px;text-align:left;">
            <div style="display:flex;justify-content:space-between;font-size:13px;margin-bottom:6px;"><span style="color:var(--text-muted);">Thoughts</span><span id="export-thought-count" style="color:var(--text-primary);font-weight:500;">0</span></div>
            <div style="display:flex;justify-content:space-between;font-size:13px;margin-bottom:6px;"><span style="color:var(--text-muted);">Habits</span><span id="export-habit-count" style="color:var(--text-primary);font-weight:500;">0</span></div>
            <div style="display:flex;justify-content:space-between;font-size:13px;"><span style="color:var(--text-muted);">Habit entries</span><span id="export-entry-count" style="color:var(--text-primary);font-weight:500;">0</span></div>
        </div>
        <div style="display:flex;gap:10px;">
            <button class="action-btn secondary" id="export-cancel" style="min-width:0;flex:1;background:rgba(196,180,138,.15);border-color:rgba(196,180,138,.25);color:#c4b48a;">Cancel</button>
            <button class="action-btn primary" id="export-confirm" style="min-width:0;flex:1;background:linear-gradient(135deg,#d4c4a0 0%,#c4b48a 50%,#a89870 100%);color:var(--bg-deep);border:none;">Export</button>
        </div>
    </div></div>
    <!-- API KEY MODAL -->
    <div class="modal-overlay" id="api-key-overlay"><div class="modal-dialog" style="max-width:380px;padding:24px;">
        <button class="modal-close-x" id="api-key-close-x"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
        <div class="modal-title" style="margin-bottom:6px;">Gemini API Key</div>
        <div style="font-size:12px;color:var(--text-muted);margin-bottom:16px;">From Google AI Studio. Leave empty to clear.</div>
        <input type="text" id="api-key-input" autocomplete="off" data-form-type="other" readonly onfocus="this.removeAttribute('readonly')" placeholder="Paste your API key..." style="width:100%;padding:12px 14px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);color:var(--text-primary);font-family:var(--font-body);font-size:14px;outline:none;box-sizing:border-box;">
        <div style="display:flex;gap:10px;margin-top:16px;">
            <button class="action-btn secondary" id="api-key-cancel" style="min-width:0;flex:1;background:rgba(196,180,138,.15);border-color:rgba(196,180,138,.25);color:#c4b48a;">Cancel</button>
            <button class="action-btn primary" id="api-key-save" style="min-width:0;flex:1;background:linear-gradient(135deg,#d4c4a0 0%,#c4b48a 50%,#a89870 100%);color:var(--bg-deep);border:none;">Save</button>
        </div>
    </div></div>
    <div class="refine-overlay" id="refine-overlay"><div class="refine-header"><button class="refine-dismiss" id="refine-dismiss">Cancel</button><div class="refine-header-title">Refine</div><div style="width:50px;"></div></div><div class="refine-body" id="refine-body"></div><div class="refine-actions" id="refine-actions" style="display:none;"><button class="action-btn secondary" id="refine-reject">Dismiss</button><button class="action-btn warm" id="refine-accept">Accept</button></div></div>
</div>
    <div class="modal-overlay" id="write-overlay"><div class="modal-dialog" style="max-width:420px;padding:28px 24px;text-align:left;">
        <button class="modal-close-x" id="write-close-x" style="top:12px;right:12px;z-index:5;"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
        <div class="modal-title" style="margin-bottom:16px;text-align:center;">Whatâ€™s on your mind?</div>
        <input type="text" id="write-title-input" autocomplete="off" data-form-type="other" readonly onfocus="this.removeAttribute('readonly')" placeholder="Title (optional)" style="display:none;width:100%;padding:10px 14px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);color:var(--text-primary);font-family:var(--font-body);font-size:14px;outline:none;box-sizing:border-box;margin-bottom:10px;">
        <div class="write-textarea-wrap"><textarea id="write-textarea" autocomplete="off" data-form-type="other" readonly onfocus="this.removeAttribute('readonly')" style="width:100%;min-height:140px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);padding:14px;color:var(--text-primary);font-family:var(--font-body);font-size:15px;line-height:1.6;resize:vertical;outline:none;box-sizing:border-box;" placeholder="Start writing..."></textarea></div>
        <div id="write-refine-preview" style="display:none;margin-top:12px;padding:12px 14px;background:var(--bg-elevated);border:1px solid rgba(196,180,138,.25);border-radius:var(--radius-md);font-size:14px;line-height:1.6;color:var(--text-primary);max-height:140px;overflow-y:auto;"></div>
        <div id="write-refine-actions" style="display:none;gap:10px;justify-content:center;margin-top:10px;padding:0 8px;">
            <button class="action-btn secondary" id="write-refine-dismiss" style="min-width:0;padding:8px 0;flex:1;background:rgba(196,180,138,.15);border-color:rgba(196,180,138,.25);color:#c4b48a;font-size:12px;">Dismiss</button>
            <button class="action-btn primary" id="write-refine-accept" style="min-width:0;padding:8px 0;flex:1;background:linear-gradient(135deg,#d4c4a0 0%,#c4b48a 50%,#a89870 100%);color:var(--bg-deep);border:none;font-size:12px;">Accept</button>
        </div>
        <div id="write-refine-status" style="display:none;font-size:11px;text-align:center;margin-top:6px;"></div>
        <div style="display:flex;gap:12px;align-items:center;justify-content:center;margin-top:16px;padding:0 8px;">
            <button class="action-btn secondary" id="write-cancel" style="padding:10px 0;flex:1;min-width:0;background:rgba(196,180,138,.15);border-color:rgba(196,180,138,.25);color:#c4b48a;">Cancel</button>
            <div class="gemini-btn-wrap"><div class="gemini-ripple"></div><div class="gemini-ripple"></div><button id="write-refine-btn" style="width:44px;height:44px;border-radius:50%;border:1px solid rgba(196,180,138,.3);background:rgba(196,180,138,.1);color:#c4b48a;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s ease;position:relative;z-index:1;" title="Refine with AI"><svg style="width:18px;height:18px;" viewBox="0 0 24 24" fill="none"><path d="M12 2L14.5 9.5L22 12L14.5 14.5L12 22L9.5 14.5L2 12L9.5 9.5L12 2Z" fill="#c4b48a" stroke="#c4b48a" stroke-width="0.5"/></svg></button></div>
            <button class="action-btn primary" id="write-save" style="padding:10px 0;flex:1;min-width:0;background:linear-gradient(135deg,#d4c4a0 0%,#c4b48a 50%,#a89870 100%);color:var(--bg-deep);border:none;">Save</button>
        </div>
    </div></div>
    <div class="modal-overlay" id="date-range-overlay"><div class="modal-dialog" style="max-width:340px;padding:20px;">
        <button class="modal-close-x" id="date-range-close-x"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
        <div class="modal-title" style="margin-bottom:16px;">Filter by date</div>
        <div style="display:flex;flex-direction:column;gap:12px;margin-bottom:16px;">
            <div style="display:flex;align-items:center;gap:8px;">
                <label style="font-size:12px;color:var(--text-muted);min-width:40px;">From</label>
                <input type="date" id="date-range-start" style="flex:1;padding:8px 12px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-sm);color:var(--text-primary);font-family:var(--font-body);font-size:14px;">
            </div>
            <div style="display:flex;align-items:center;gap:8px;">
                <label style="font-size:12px;color:var(--text-muted);min-width:40px;">To</label>
                <input type="date" id="date-range-end" style="flex:1;padding:8px 12px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-sm);color:var(--text-primary);font-family:var(--font-body);font-size:14px;">
            </div>
        </div>
        <div style="display:flex;gap:10px;justify-content:center;">
            <button class="action-btn secondary" id="date-range-clear" style="padding:10px 0;width:45%;background:rgba(196,180,138,.15);border-color:rgba(196,180,138,.25);color:#c4b48a;">Clear</button>
            <button class="action-btn primary" id="date-range-select" style="padding:10px 0;width:45%;background:linear-gradient(135deg,#d4c4a0 0%,#c4b48a 50%,#a89870 100%);border:none;color:var(--bg-deep);">Select</button>
        </div>
    </div></div>

    <!-- MULTI-SELECT ACTION BARS -->
    <div class="select-action-bar" id="thoughts-select-bar">
        <span class="select-action-count" id="thoughts-select-count">0 selected</span>
        <div style="display:flex;gap:10px;">
            <button class="select-action-cancel" id="thoughts-select-cancel">Cancel</button>
            <button class="select-action-delete thoughts-delete" id="thoughts-select-delete">Delete</button>
        </div>
    </div>
    <div class="select-action-bar" id="habits-select-bar">
        <span class="select-action-count" id="habits-select-count">0 selected</span>
        <div style="display:flex;gap:10px;">
            <button class="select-action-cancel" id="habits-select-cancel">Cancel</button>
            <button class="select-action-delete habits-delete" id="habits-select-delete">Delete</button>
        </div>
    </div>
    <div class="select-action-bar" id="habit-entries-select-bar">
        <span class="select-action-count" id="habit-entries-select-count">0 selected</span>
        <div style="display:flex;gap:10px;">
            <button class="select-action-cancel" id="habit-entries-select-cancel">Cancel</button>
            <button class="select-action-delete habits-delete" id="habit-entries-select-delete">Delete</button>
        </div>
    </div>

    <!-- AUTH LOGIN -->
    <div class="modal-overlay" id="auth-overlay" style="z-index:9999;"><div class="modal-dialog" style="max-width:340px;padding:28px 24px;text-align:center;">
        <div style="font-size:28px;margin-bottom:8px;">ğŸŒ¿</div>
        <div class="modal-title" style="margin-bottom:4px;">Welcome to Speak</div>
        <div style="font-size:13px;color:var(--text-muted);margin-bottom:20px;">Sign in to sync your data</div>
        <input type="email" id="auth-email" autocomplete="off" data-form-type="other" readonly onfocus="this.removeAttribute('readonly')" placeholder="Email" style="width:100%;padding:12px 14px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);color:var(--text-primary);font-family:var(--font-body);font-size:15px;outline:none;box-sizing:border-box;margin-bottom:10px;">
        <input type="password" id="auth-password" autocomplete="off" data-form-type="other" readonly onfocus="this.removeAttribute('readonly')" placeholder="Password" style="width:100%;padding:12px 14px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);color:var(--text-primary);font-family:var(--font-body);font-size:15px;outline:none;box-sizing:border-box;margin-bottom:16px;">
        <div id="auth-error" style="display:none;font-size:12px;color:#e07a5f;margin-bottom:12px;"></div>
        <button class="action-btn primary" id="auth-login-btn" style="width:100%;padding:12px;background:linear-gradient(135deg,#7da87a 0%,#5e8a5a 50%,#4a7248 100%);color:var(--bg-deep);border:none;font-size:15px;font-weight:600;border-radius:var(--radius-md);cursor:pointer;">Sign in</button>
        <button id="auth-signup-btn" style="background:none;border:none;color:var(--text-muted);font-size:12px;margin-top:12px;cursor:pointer;font-family:var(--font-body);">No account? <span style="color:#7da87a;">Create one</span></button>
    </div></div>

    <script src="storage.js"></script>
    <script src="supabase.js"></script>
    <script src="ai.js"></script>
    <script src="app.js"></script>
    <script src="thoughts.js"></script>
    <script src="habits.js"></script>
    <script src="insights.js"></script>
</body>
</html>
